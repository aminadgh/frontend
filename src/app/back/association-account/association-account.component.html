<app-admin-navbar></app-admin-navbar>
<!-- Hero Start -->
<section class="bg-half-170 d-table w-100" style="background: url('assets/images/hero/pages.jpg') center;">
  <div class="bg-overlay bg-gradient-overlay"></div>
  <div class="container">
      <div class="row mt-5 justify-content-center">
          <div class="col-12">
              <div class="title-heading text-center">
                  <h5 class="heading fw-semibold mb-0 sub-heading text-white title-dark">Association Account</h5>
              </div>
          </div><!--end col-->
      </div><!--end row-->

      <div class="position-middle-bottom">
          <nav aria-label="breadcrumb" class="d-block">
              <ul class="breadcrumb breadcrumb-muted mb-0 p-0">
                  <li class="breadcrumb-item"><a [routerLink]="'/'">Solidarity&Refugee</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Association Account</li>
              </ul>
          </nav>
      </div>
  </div><!--end container-->
</section><!--end section-->

<div class="position-relative">
  <div class="shape overflow-hidden text-white">
      <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 48H1437.5H2880V0H2160C1442.5 52 720 0 720 0H0V48Z" fill="currentColor"></path>
      </svg>
  </div>
</div>
<!-- Hero End -->


<section class="section">
  <div class="container">
    <!-- Loading State -->
    <div *ngIf="loading" class="text-center p-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="alert alert-danger">
      {{error}}
    </div>

    <!-- Dashboard Content -->
    <div *ngIf="association && !loading" class="dashboard">
      <!-- Welcome Banner -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card bg-primary text-white">
            <div class="card-body d-flex justify-content-between align-items-center">
              <div>
                <h4 class="text-white mb-1">Welcome back, {{association.name}}!</h4>
                <p class="mb-0">Here's what's happening with your association today.</p>
              </div>
              <div class="text-end">
                <span class="badge bg-light text-primary">{{association.verificationStatus | titlecase}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Statistics Cards -->
      <div class="row g-4 mb-4">
        <div class="col-md-3">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                  <i class="uil uil-money-bill text-primary fs-4"></i>
                </div>
                <div class="ms-3">
                  <h6 class="mb-1">Total Donations</h6>
                  <h4 class="mb-0">{{association?.statistics?.totalDonations | tnd}}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="rounded-circle bg-success bg-opacity-10 p-3">
                  <i class="uil uil-users-alt text-success fs-4"></i>
                </div>
                <div class="ms-3">
                  <h6 class="mb-1">Beneficiaries</h6>
                  <h4 class="mb-0">{{association.statistics.totalBeneficiaries}}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="rounded-circle bg-warning bg-opacity-10 p-3">
                  <i class="uil uil-heartbeat text-warning fs-4"></i>
                </div>
                <div class="ms-3">
                  <h6 class="mb-1">Active Cases</h6>
                  <h4 class="mb-0">{{association.statistics.activeAidCases}}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="rounded-circle bg-info bg-opacity-10 p-3">
                  <i class="uil uil-check-circle text-info fs-4"></i>
                </div>
                <div class="ms-3">
                  <h6 class="mb-1">Completed</h6>
                  <h4 class="mb-0">{{association.statistics.completedAidCases}}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions & Recent Activity -->
      <div class="row">
        <!-- Quick Actions -->
        <div class="col-lg-4">
          <div class="card border-0 shadow-sm">
            <div class="card-header bg-transparent">
              <h5 class="mb-0">Quick Actions</h5>
            </div>
            <div class="card-body">
              <div class="list-group">
                <button class="list-group-item list-group-item-action d-flex align-items-center" 
                        (click)="onCreateAidAnnouncement()">
                  <i class="uil uil-plus-circle text-primary me-2"></i>
                  Create Aid Case
                </button>
                <button class="list-group-item list-group-item-action d-flex align-items-center"
                        (click)="onCreateEvent()">
                  <i class="uil uil-calendar-alt text-success me-2"></i>
                  Schedule Event
                </button>
                <button class="list-group-item list-group-item-action d-flex align-items-center"
                        (click)="onUploadMedia()">
                  <i class="uil uil-image-upload text-info me-2"></i>
                  Upload Media
                </button>
                <button class="list-group-item list-group-item-action d-flex align-items-center"
                        (click)="onManageMembers()">
                  <i class="uil uil-users-alt text-warning me-2"></i>
                  Manage Members
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="col-lg-8">
          <div class="card border-0 shadow-sm">
            <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Recent Activity</h5>
              <div class="btn-group">
                <button class="btn btn-sm btn-outline-primary" [class.active]="activityFilter === 'all'"
                        (click)="setActivityFilter('all')">All</button>
                <button class="btn btn-sm btn-outline-primary" [class.active]="activityFilter === 'donations'"
                        (click)="setActivityFilter('donations')">Donations</button>
                <button class="btn btn-sm btn-outline-primary" [class.active]="activityFilter === 'cases'"
                        (click)="setActivityFilter('cases')">Cases</button>
              </div>
            </div>
            <div class="card-body p-0">
              <div class="list-group list-group-flush">
                <div *ngFor="let activity of filteredActivities" 
                     class="list-group-item d-flex align-items-center p-3">
                  <div [class]="'activity-icon ' + activity.type">
                    <i [class]="'uil ' + getActivityIcon(activity.type)"></i>
                  </div>
                  <div class="ms-3 flex-grow-1">
                    <h6 class="mb-1">{{activity.title}}</h6>
                    <p class="mb-0 text-muted small">{{activity.description}}</p>
                  </div>
                  <small class="text-muted">{{activity.date | timeAgo}}</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Aid Cases -->
      <div class="row mt-4">
        <div class="col-12">
          <div class="card border-0 shadow-sm">
            <div class="card-header bg-transparent">
              <h5 class="mb-0">Recent Aid Cases</h5>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>Title</th>
                      <th>Urgency</th>
                      <th>Target</th>
                      <th>Raised</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let case of association.aidCases.slice(0, 5)">
                      <td>{{case.title}}</td>
                      <td>
                        <span [class]="'badge bg-' + getUrgencyClass(case.urgencyLevel)">
                          {{case.urgencyLevel}}
                        </span>
                      </td>
                      <td>{{case.targetAmount | currency}}</td>
                      <td>
                        <div class="progress" style="height: 5px;">
                          <div class="progress-bar" 
                               [style.width]="(case.raisedAmount! / case.targetAmount! * 100) + '%'">
                          </div>
                        </div>
                        <small class="text-muted">{{case.raisedAmount | currency}}</small>
                      </td>
                      <td>
                        <span [class]="'badge bg-' + getStatusClass(case.status)">
                          {{case.status}}
                        </span>
                      </td>
                      <td>
                        <button class="btn btn-sm btn-primary me-1" (click)="viewCase(case)">
                          View
                        </button>
                        <button class="btn btn-sm btn-outline-primary" (click)="editCase(case)">
                          Edit
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Example of updated content -->
      <div class="team-members">
        <h3>Membres de l'équipe</h3>
        <ul>
          <li *ngFor="let member of association?.teamMembers">
            <img [src]="member.avatar || 'assets/images/avatar-placeholder.png'" alt="Photo de profil">
            <div class="member-info">
              <h4>{{ member.name }}</h4>
              <p>{{ member.role === 'admin' ? 'Administrateur' : 
                   member.role === 'manager' ? 'Gestionnaire' : 'Membre' }}</p>
            </div>
          </li>
        </ul>
      </div>

      <div class="statistics">
        <h3>Statistiques</h3>
        <div class="stat-item">
          <span class="label">Dons totaux:</span>
          <span class="value">{{ association?.statistics?.totalDonations | tnd }}</span>
        </div>
        <!-- ... other stats ... -->
      </div>
    </div>
  </div>
</section>

